# Thesis_programs
All necessary codes for reproducing data from my thesis

The file summary.md gives a brief outline of which codes are included here. In this README I will discuss how results presented in the thesis are obtained.

Most results concern test particle orbits. 2D results are obtained by setting FMOD = CMT in line 14 of global_mod.f90 and 3D results are found by setting FMOD to CMT2. The simple model and braking jet model both exist in CMTfields_mod.f90 with certain lines being commented in/out to ensure that the correct transformation is used. The simple model is used as long as lines 59-65 are commented out and lines 57 and 137-145 are not commented out, the reverse is true for the braking jet model.

Initial conditions are specified in newinput.dat. When setting up either the simple model or the braking jet model it is extremely important to make sure that the correct initial time and time scale are set up for the model in question. The simple model takes an initial time of 105.0 and has a time scale of 100.0, whereas the braking jet model starts at 0.0 and has a time scale of 10.0. 

I will discuss how to generate figures and tables that present new results, grouping together figures which are generated by similar processes.

Figures 16, 18, 20, 21, 23, 24, 25, 26, 28, 29, 30: These figures are all generated by scattercol4.pro which reads in data sets, finds the ratio of final to initial field strength and the ratio of final to initial energy and plots these against each other. The final time is determined as the final crossing of the loop top. To display several data sets at once the program uses the wkdir variable in getrdata.pro to obtain results from different data sets. By default, results are drawn from the Data/DataR directory, but relevant data sets can be grouped in named directories which are then set equal to wkdir. When fewer datasets are displayed in a figure, lines of code relating to data sets not in use can be commented out.

Figure 17: These simple plots show information about the Fermi acceleration contribution to the particle's energy. This property is found by setting a dataset ds=getrdata(n,/ke). From here ds.e5 will describe the size of this term at each point in time. In fact, e4-e9 all keep track of terms on the right hand side of dgamma/dt. Their meanings are secribed in r_kdrive_mod.f90

Figure 19: This is also produced using scattercol4.pro. To obtain test particle orbits in fields that collapse faster it is necessary to change the variables esp and cc on lines 111 and 112 of global_mod.f90.

Figures 38, 39, 46: These figures uses manyplots.pro to show multiple energy profiles at once for particles in the 3D CMT with a braking jet. The lower bound for x and z in newinput.dat is -1.2e7 and the upper bound is -0.001e7. This means that particles start very close to but not at x=0 or z=0. This prevents a singularity in the terms dr/dx or drdz found in CMTfields_mod.f90, which would become 0/0 with these numbers.

Figures 41, 42, 49: These figures show how the energies of particles change with time by plotting ds.ke against ds.t, where the dataset is obained using ds = getrdata(n,/ke)

Figure 43: Similar to the scatter plots in the previous chapter, though this one uses abscatter.pro so that particles which escape early appear greyer. 

Figures 44, 45, 48: Particle trajectories (in the x-y plane) are shown by plotting ds.y against ds.x. 

Figure 47: Similar to Figures 38, 39 and 46, but with the pitch angle and z varied instead of x and z.

Figure 50, Movies 1 and 2: 

Figure 51: 
